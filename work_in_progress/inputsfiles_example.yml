name: inputfiles_example
# Guy Bowker

archive: dropbox
run_options:
#  l: s_rt=12:00:00 # define wallclock
  l: short # puts in short queue (1hr max)

tasks:
  # task_1_generate_volume_element_from_damask_input_files
  - name: generate_volume_element
    method: from_damask_input_files
    software: damask
    base:
      geom_path: mnt/full/path/to/file.geom
      material_path: /mnt/full/path/to/file/material.yml

  # task_2_generate_load_case_plane_strain
  - name: generate_load_case
    method: plane_strain
    software: formable
    base:
      total_times: [2]
      num_increments: [1000] # incs in damask.load
      target_strain_rates: [-0.5]
      directions: [zy]

  # task_3_simulate_volume_element_loading_CP_FFT
  - name: simulate_volume_element_loading
    method: CP_FFT
    software: DAMASK
    run_options:
      num_cores: 2
      l: short                 # define wallclock for just DAMASK
    output_map_options:
      operations:
        - name: add_Cauchy
          args: {P: P, F: F}
          opts: {add_Mises: true}
        - name: add_strain_tensor
          args: {F: F, t: V, m: 0}
          opts: {add_Mises: true}          
        - name: add_strain_tensor
          args: {F: Fp, t: V, m: 0}
          opts: {add_Mises: true}
#         - name: add_IPF_color                    # for future reference
#           args: {O: O, hkl: [0.0, 0.0, 1.0]}
#           opts: {}
      incremental_data:
        - name: def_grad # required for multipass
          path: constituent/1_Ti64_alpha/generic/F
          transforms: [mean_along_axes: 1]
        - name: vol_avg_stress
          path: constituent/1_Ti64_alpha/generic/sigma
          transforms: [mean_along_axes: 1]
        - name: vol_avg_equivalent_stress
          path: constituent/1_Ti64_alpha/generic/sigma_vM
          transforms: [mean_along_axes: 1]
        - name: vol_avg_strain
          path: constituent/1_Ti64_alpha/generic/epsilon_V^0(F)
          transforms: [mean_along_axes: 1]
        - name: vol_avg_equivalent_strain
          path: constituent/1_Ti64_alpha/generic/epsilon_V^0(F)_vM
          transforms: [mean_along_axes: 1]
        - name: orientations
          path: constituent/1_Ti64_alpha/generic/O
          increments: 1 # extract data every 1 increment
      visualise:
        increments: [0, 10, 20, 30, 40, 50, 60, 70, 80, -1] # Generate a VTK file for the initial and final increments
        labels: ['F', 'P', 'sigma', 'sigma_vM', 'epsilon_V^0(F)', 'epsilon_V^0(F)_vM'] # , 'IPFcolor_[0\ 0\ 1]'] # quantities in VTK  
    base:
      homogenization_schemes:
        SX:
          mech:
            type: none
      phases:
        Ti64_alpha: # ------------------------------------------------------
          elasticity:
            type: hooke                # S = C.E
            C_11: 160.0e9              # elasticity stiffness tensor constants
            C_12: 90.0e9
            C_13: 66.0e9
            C_33: 181.7e9
            C_44: 46.5e9
          generic:
            output: [F, P, Fp, O]
          lattice: hex                 # define CS
          c/a: 1.587                   # <c>/<a>
          plasticity:
            N_sl: [3, 3, 0, 6]         # number of slip systems [basal,prism,pyrm1,pyrm2]
            a_sl: 2.0                  # ?
            a_tol_xi: 1.0              # ?
            dot_gamma_0_sl: 0.001      # initial shear rate
            h_sl_sl: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] # hardening/dependancy matrix
            h_0_sl_sl: 15.0e6          # initial hardening slsl interaction
            n_sl: 10                   # stress exponent 1/m (m=strain rate sensitivity)
            output: [gamma_sl, xi_sl]
            xi_0_sl: [100.0e+06, 100.0e+06, 0.0, 200.0e+06]   # CRSS initial
            xi_inf_sl: [100.0e+06, 100.0e+06, 0.0, 200.0e+06] # CRSS hardened
            type: phenopowerlaw

          # plastic from M. Levy, Handbook of Elastic Properties of Solids, Liquids, and Gases (2001)
          # Plastic from C. Zambaldi, "Orientation informed nanoindentation of a-titanium: Indentation pileup in hexagonal metals deforming by prismatic slip", J. Mater. Res., Vol. 27, No. 1, Jan 14, 2012
          # elastic+plastic from L. Wang, Z. Zheng, H. Phukan, P. Kenesei, J.-S. Park, J. Lind, R.M. Suter, T.R. Bieler, Direct measurement of critical resolved shear stress of prismatic and basal slip in polycrystalline Ti using high energy X-ray diffraction microscopy, Acta Mater 2017

        Ti64_beta: # -------------------------------------------------------
          elasticity:
            type: hooke                # S = C.E
            C_11: 233.3e9              # elasticity stiffness tensor constants
            C_12: 135.5e9
            C_44: 118.0e9
          generic:
            output: [F, Fe, Fp, P, Lp, O]
          lattice: bcc                 # define CS
          plasticity:
            N_sl: [12, 12]             # number of slip systems [{110}<111>, {112}<111>, ({123}<111>?)]
            a_sl: 2.0                  # ?
            atol_xi: 1.0               # ?
            dot_gamma_0_sl: 0.001      # initial shear rate
            h_0_sl_sl: 1000.0e6        # initial hardening slsl interaction
            h_sl_sl: [1, 1, 1.4, 1.4, 1.4, 1.4] # hardening/dependancy matrix
            n_sl: 10                   # stress exponent 1/m (m=strain rate sensistivity)
            output: [gamma_sl, xi_sl]
            xi_0_sl: [33.3e6, 33.3e6]   # CRSS initial
            xi_inf_sl: [33.3e6, 33.3e6] # CRSS final
            type: phenopowerlaw
