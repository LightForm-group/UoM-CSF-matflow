name: import_example_simple

run_options:
  l: short

import:
  - parameter: volume_element
    from:
      # (specify either the full path to HDF5 file, or the parent directory:)
      workflow: /mnt/eps01-rds/jf01-home01/shared/matflow/workflows/completed_workflows/generate_RVE_2021-09-23-084754
      # --- Additional options ---
      # context:        # (string) optionally specify which context this comes from in the source workflow
      # task_idx:       # (int) optionally specify the task index from which to import the parameter. If give, `context` is ignored.
      # iteration:      # (int) optionally specify which iteration to use (default is final iteration, -1) in the source workflow
      # elements:       # (list of int) optionally specify which subset of elements to use (default is all elements) in the source workflow
    # as:               # (string) optionally rename the parameter for use in this workflow (default is no name change)
    # context:          # (string) optionally use a different context for the parameter in this workflow

tasks:
  - name: generate_load_case
    method: uniaxial
    software: formable
    base:
      total_times: [100]
      num_increments: [200]
      target_strain_rates: [1.0e-3]
      directions: [x]

  - name: simulate_volume_element_loading
    method: CP_FFT
    software: DAMASK
    run_options:
      num_cores: 4
      l: short
    output_map_options:
      operations:
        - name: add_stress_Cauchy
          args: { P: P, F: F }
          opts: { add_Mises: true }
        - name: add_strain
          args: { F: F, t: V, m: 0 }
          opts: { add_Mises: true }
        - name: add_strain
          args: { F: F_p, t: V, m: 0 }
          opts: { add_Mises: true }
      volume_data:
        - out_name: vol_avg_equivalent_stress
          field_name: sigma_vM
          transforms: [mean_along_axes: 1]
        - out_name: vol_avg_equivalent_strain
          field_name: epsilon_V^0(F)_vM
          transforms: [mean_along_axes: 1]
        - out_name: vol_avg_equivalent_plastic_strain
          field_name: epsilon_V^0(F_p)_+vM
          transforms: [mean_along_axes: 1]
          increments:
            - step: 10 # E.g. extract data every 10th increment.
      field_data: # `phase` and `O` field data are required if we want to later plot pole figures from the deformed RVE
        - field_name: phase
        - field_name: O
    base:
      homogenization_schemes:
        SX:
          mechanical:
            type: pass
          N_constituents: 1
      phases:
        Al:
          lattice: cF
          mechanical:
            output: [F, P, F_p]
            elastic:
              type: Hooke
              C_11: 106.75e9
              C_12: 60.41e9
              C_44: 28.34e9
            plastic:
              type: phenopowerlaw
              output: [xi_sl]
              N_sl: [12]
              n_sl: 20
              a_sl: 2.25
              dot_gamma_0_sl: 0.001
              h_0_sl_sl: 573e6
              h_sl_sl: [1, 1, 1.4, 1.4, 1.4, 1.4]
              xi_0_sl: [22e6]
              xi_inf_sl: [129e6]
