name: tension_DAMASK_Mg

# archive: dropbox
run_options:
  l: short

tasks:

  - name: generate_microstructure_seeds
    method: random
    software: damask
    base:
      size: [1, 1, 1]
      num_grains: 100
    output_map_options:
      phase_label: Mg

  - name: generate_volume_element
    method: random_voronoi
    software: damask
    base:
      grid_size: [16, 16, 16]
      homog_label: SX

  - name: visualise_volume_element
    method: VTK
    software: damask

  - name: generate_load_case
    method: uniaxial
    software: formable
    base:
      total_times: [50]
      num_increments: [2000]
      target_strain_rates: [1.0e-3]
      directions: [x]

  - name: simulate_volume_element_loading
    method: CP_FFT
    software: DAMASK
    run_options:
      num_cores: 4
      l: short
    output_map_options:
      operations:
        - name: add_Cauchy
          args: {P: P, F: F}
          opts: {add_Mises: true}
        - name: add_strain_tensor
          args: {F: F, t: V, m: 0}
          opts: {add_Mises: true}          
        - name: add_strain_tensor
          args: {F: Fp, t: V, m: 0}
          opts: {add_Mises: true}
      incremental_data:
        - name: vol_avg_equivalent_stress
          path: constituent/1_Mg/generic/sigma_vM
          transforms: [mean_along_axes: 1]
        - name: vol_avg_equivalent_strain
          path: constituent/1_Mg/generic/epsilon_V^0(F)_vM
          transforms: [mean_along_axes: 1]
        - name: vol_avg_equivalent_plastic_strain
          path: constituent/1_Mg/generic/epsilon_V^0(Fp)_vM
          transforms: [mean_along_axes: 1]
          increments: 10 # E.g. extract data every 10th increment.
      visualise:
        increments: [0, -1] # Generate a VTK file for the initial and final increments
        labels: ['F', 'P', 'sigma_vM']          
    base:
      homogenization_schemes:
        SX:
          mech:
            type: none
      numerics:
        grid:
          maxCutBack: 8            
      phases:
        Mg:
          generic:
            output:
              - F       # deformation gradient (total)
              - P       # stress (piola-kirchoff)
              - Fp      # deformation gradient (plastic part)
              - O       # orientations (as quaternions)
          lattice: hex            
          c/a: 1.62350                                      # from Tromans 2011, Elastic Anisotropy of HCP Metal Crystals and Polycrystals
          elasticity:
            type: hooke
            C_11: 59.3e9
            C_12: 25.7e9
            C_13: 21.4e9
            C_33: 61.5e9
            C_44: 16.4e9
          plasticity:
            type: phenopowerlaw
            output:
              - gamma_sl # slip volume fraction
              - gamma_tw # twinning volume fraction
              - xi_sl    # slip resistance
              - xi_tw    # twinning resistance          
            N_sl:       [3, 3, 0, 0, 0, 0]                                # Number of slip systems to include - basal  prism  prism pyr(a) pyr(c+a) pyr(c+a)
            xi_0_sl:    [50e6, 150e6,  0.0,   0.0,  0.0,   0.0]           # basal  prism  prism pyr(a) pyr(c+a) pyr(c+a) 
            xi_inf_sl:  [100e6, 300e6,  0.0,  0.0,  0.0,  0.0]            # basal  prism  prism pyr(a) pyr(c+a) pyr(c+a)            
            N_tw:       [6, 0, 0, 0]                                      # Number of twin systems to include - tensile 1, compressive 1, tensile 2, compressive 2
            xi_0_tw:    [300e6,  0.0,  0.0,  0]                           # tensile 1, compressive 1, tensile 2, compressive 2
            a_sl: 2.25
            atol_xi: 1.0
            dot_gamma_0_sl: 0.001
            h_0_sl_sl: 500.0e6
            h_sl_sl: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1,   1, 1, 1, 1, 1, 1, 1, 1, 1, 1,    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,   1, 1]  # just guessing
            n_sl: 20            
            dot_gamma_0_tw: 0.001
            c_1: 0.0
            c_2: 0.0
            c_3: 20.0
            c_4: 20.0
            f_sl_sat_tw: 10.0
            h_0_tw_tw: 50.0e6
            h_0_tw_sl: 150.0e6
            h_tw_tw: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1,   1, 1, 1, 1, 1, 1, 1, 1, 1, 1]                                                      #  - " - 
            h_sl_tw: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1,   1, 1, 1, 1, 1, 1, 1, 1, 1, 1,    1, 1, 1, 1]                                           #  - " - 
            h_tw_sl: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1,   1, 1, 1, 1, 1, 1, 1, 1, 1, 1,    1, 1, 1, 1]                                           #  - " - 
            n_tw: 20
